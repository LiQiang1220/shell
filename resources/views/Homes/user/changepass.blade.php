


<!DOCTYPE html> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-cn" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit" />

<link href="https://hwid1.vmallres.com/CAS/up/rss_16/../common/images/default/hwfavicon.ico" type="image/x-icon" rel="shortcut icon" /> 
<link href="/Homes/css/ec.core.css" rel="stylesheet" type="text/css"> 
<link href="/Homes/css/common.css" rel="stylesheet" type="text/css"> 
<link href="/Homes/css/dialog.css" rel="stylesheet" type="text/css"> 
<link href="/Homes/css/common_1.css" rel="stylesheet" type="text/css"> 
<link href="/Homes/css/zh-cn_css.css" rel="stylesheet" type="text/css"> 
<link href="/Homes/css/commonemui5.css" rel="stylesheet" type="text/css"> 
<script type="text/javascript">var localHttps="https://hwid1.vmall.com/CAS";var currentSiteID="1";</script>
<script src="/Homes/js/jsapi.js" namespace="ec"></script>
<script src="/Homes/js/jquery-1.8.2.min.js" id=jsid></script>
<script src="/Homes/js/ec.core.js"></script>
<script src="/Homes/js/base.js"></script>
<script src="/Homes/js/casui.js"></script>
<script src="/Homes/js/ec.business.js"></script> 
<script src="/Homes/js/commonjs.js"></script>
<script src="/Homes/js/casajaxobj.js"></script>


<title>华为帐号-输入华为帐号</title>
<script src="js/jquery.validator.js"></script>
<script type="text/javascript">
var jsdevswfpath = htmlDecodeJQ("https://hwid1.vmall.com/CAS/up/rss_16/js/pc_rss/secrisk/JSdev.swf?UP_CAS_2.6.0.102");
var rss={
		login_js_codeerror :htmlDecodeJQ("&#39564;&#35777;&#30721;&#38169;&#35823;"),
		inputcode:htmlDecodeJQ("&#35831;&#36755;&#20837;&#39564;&#35777;&#30721;"),
		wrongcode:htmlDecodeJQ("&#39564;&#35777;&#30721;&#38169;&#35823;"),
		getsmscodefail:htmlDecodeJQ("&#33719;&#21462;&#30701;&#20449;&#39564;&#35777;&#30721;&#22833;&#36133;"),
		getsmscode:htmlDecodeJQ("&#33719;&#21462;&#39564;&#35777;&#30721; "),
		getpwdfail:htmlDecodeJQ("&#37325;&#32622;&#23494;&#30721;&#22833;&#36133;"),
		forgetbyid_usernoexist:htmlDecodeJQ("&#35813;&#21326;&#20026;&#24080;&#21495;&#36824;&#26410;&#27880;&#20876;&#65281;"),
		common_js_send_sms_in_min:htmlDecodeJQ("&#19968;&#20998;&#38047;&#20869;&#21482;&#20801;&#35768;&#35831;&#27714;&#19968;&#27425;&#65292;&#35831;&#31245;&#21518;&#37325;&#35797;"),
		common_js_send_sms_in_week:htmlDecodeJQ("&#36229;&#20986;&#19968;&#21608;&#20869;&#21457;&#36865;&#39564;&#35777;&#30721;&#30340;&#26368;&#22823;&#27425;&#25968;"),
		common_js_send_sms_in_day:htmlDecodeJQ("&#33719;&#21462;&#30701;&#20449;&#27425;&#25968;&#22826;&#39057;&#32321;&#65292;&#35831;&#26126;&#22825;&#20877;&#35797;"),
		common_js_wrongcode:htmlDecodeJQ("&#39564;&#35777;&#30721;&#38169;&#35823;"),
		login_js_inputaccount :htmlDecodeJQ("&#35831;&#36755;&#20837;&#24744;&#30340;&#24080;&#21495;"),
		login_js_accountlength :htmlDecodeJQ("&#21326;&#20026;&#24080;&#21495;&#38480;&#21046;&#22312;4~50 &#20010;&#23383;&#31526;"),
		prompt:htmlDecodeJQ("&#25552;&#31034;"),
		iKnowBtn:htmlDecodeJQ("&#30830;&#23450;"),
		noSupportService:htmlDecodeJQ("&#24403;&#21069;&#32593;&#31449;&#30340;&#26381;&#21153;&#33539;&#22260;&#19982;&#24744;&#36755;&#20837;&#30340;&#24080;&#21495;&#19981;&#21305;&#37197;&#65292;&#31995;&#32479;&#26080;&#27861;&#20026;&#24744;&#25552;&#20379;&#26381;&#21153;&#65292;&#25964;&#35831;&#35845;&#35299;&#12290;"),
		error_10000001:htmlDecodeJQ("&#35831;&#36755;&#20837;&#27491;&#30830;&#30340;&#24080;&#21495;"),
		error_10000002:htmlDecodeJQ("&#19981;&#25552;&#20379;&#26381;&#21153;"),
		error_10000003:htmlDecodeJQ("&#35813;&#24080;&#21495;&#24050;&#34987;&#20923;&#32467;"),
		error_10000004:htmlDecodeJQ("&#38750;&#27861;&#25805;&#20316;!"),
		
		
		error_10001003: htmlDecodeJQ("&#23433;&#20840;&#25163;&#26426;&#21495;&#27809;&#26377;&#28608;&#27963;&#65292;&#35831;&#36827;&#20837;&ldquo;&#24080;&#21495;&#20013;&#24515;&rdquo;&#28608;&#27963;&#23433;&#20840;&#25163;&#26426;&#21495;&#12290;"),
		error_10001004: htmlDecodeJQ("&#23433;&#20840;&#37038;&#31665;&#27809;&#26377;&#28608;&#27963;&#65292;&#35831;&#36827;&#20837;&ldquo;&#24080;&#21495;&#20013;&#24515;&rdquo;&#28608;&#27963;&#23433;&#20840;&#25163;&#37038;&#31665;&#12290;"),
		error_70001401:htmlDecodeJQ("&#31995;&#32479;&#20869;&#37096;&#38169;&#35823;"),
		
		user_not_exsit:htmlDecodeJQ("&#24080;&#21495;&#20449;&#24687;&#19981;&#23384;&#22312;"),
		autoCodeSuccess:htmlDecodeJQ("&#39564;&#35777;&#30721;&#27491;&#30830;"),
		accountNotActive:htmlDecodeJQ("&#24080;&#21495;&#26410;&#28608;&#27963;"),
		IGetIt:htmlDecodeJQ("&#30830;&#23450;"),
		hint:htmlDecodeJQ("&#25552;&#31034;"),
		loginOverdue:htmlDecodeJQ("&#24403;&#21069;&#39029;&#38754;&#24050;&#36807;&#26399;&#65292;&#35831;&#21047;&#26032;&#24403;&#21069;&#39029;&#38754;&#21518;&#37325;&#35797;&#12290;"),
		overload:htmlDecodeJQ("&#31995;&#32479;&#32321;&#24537;&#65292;&#35831;&#31245;&#21518;&#20877;&#35797;&#65281;"),
		global_cross_site_login:htmlDecodeJQ("&#38656;&#35201;&#24744;&#21516;&#24847;&#24403;&#21069;&#22269;&#23478;/&#22320;&#21306;&#30340;&#38544;&#31169;&#25919;&#31574;&#12290;&#28857;&#20987;&#21516;&#24847;&#65292;&#21363;&#34920;&#31034;&#24744;&#24050;&#38405;&#35835;&#21644;&#21516;&#24847;&#21326;&#20026;&lt;a class='a-EMUI5' id='globalCrossPrivacyPolicy' target='_blank'&gt;&#38544;&#31169;&#25919;&#31574;&lt;/a&gt;&#12290;"),
		error_risk_70008800:htmlDecodeJQ("&#24744;&#30340;&#25805;&#20316;&#21487;&#33021;&#23384;&#22312;&#23433;&#20840;&#39118;&#38505;&#65292;&#24314;&#35758;&#24744;&#19981;&#35201;&#36827;&#34892;&#27492;&#25805;&#20316;&#25110;&#31245;&#21518;&#20877;&#35797;&#12290;"),
		global_cross_page_redirect_forget:htmlDecodeJQ("&#24403;&#21069;&#32593;&#31449;&#19981;&#25903;&#25345;&#35813;&#24080;&#21495;&#25214;&#22238;&#23494;&#30721;&#65292;&#23558;&#36339;&#36716;&#21040;&#24080;&#21495;&#27880;&#20876;&#22269;&#23478;/&#22320;&#21306;&#23545;&#24212;&#30340;&#32593;&#31449;&#25214;&#22238;&#23494;&#30721;&#12290;"),
		cancel_btn:htmlDecodeJQ("&#21462;&#28040;")
};
var lang= htmlDecodeJQ("zh-cn");
var randomCodeImgURL = htmlDecodeJQ("https://hwid1.vmall.com/Captcha/authCodeImage?session_code_key=p_forget_byid_session_ramdom_code_key&amp;amp;_st=1515978750176");
var pageToken = htmlDecodeJQ("tWnLNjXahsUyaN2NmrF3nFnNd9fbTpPW");
var localInfo = 
    {
	  webssoLoginSessionCode:htmlDecodeJQ("https://hwid1.vmall.com/Captcha/authCodeImage?session_code_key=p_forget_byid_session_ramdom_code_key&amp;_st=1515978750176"),
	  currentSiteID:htmlDecodeJQ("1"),
	  urlQurey:htmlDecodeJQ("?reqClientType=26&loginChannel=26000000&countryCode=cn&loginUrl=https%3A%2F%2Fhwid1.vmall.com%2FCAS%2Fportal%2Flogin.html&service=https%3A%2F%2Fwww.vmall.com%2Faccount%2Facaslogin%3Furl%3Dhttps%253A%252F%252Fwww.vmall.com%252F&lang=zh-cn&themeName=red"),
	  reqClientType:htmlDecodeJQ("26"),
	  globalCrossPrivacyPolicy:htmlDecodeJQ("https://hwid1.vmall.com/CAS/portal/agreements/userPrivacyPolicy/zh-cn_userPrivacyPolicy.html?version=europe"),
	  queryString:htmlDecodeJQ("?reqClientType=26&amp;loginChannel=26000000&amp;countryCode=cn&amp;loginUrl=https%3A%2F%2Fhwid1.vmall.com%2FCAS%2Fportal%2Flogin.html&amp;service=https%3A%2F%2Fwww.vmall.com%2Faccount%2Facaslogin%3Furl%3Dhttps%253A%252F%252Fwww.vmall.com%252F&amp;lang=zh-cn&amp;themeName=red"),
	  extInfo:htmlDecodeJQ(""),
	  requestURIQuery:htmlDecodeJQ("/CAS/portal/resetPwd/forgetbyid.html?reqClientType=26&amp;loginChannel=26000000&amp;countryCode=cn&amp;loginUrl=https%3A%2F%2Fhwid1.vmall.com%2FCAS%2Fportal%2Flogin.html&amp;service=https%3A%2F%2Fwww.vmall.com%2Faccount%2Facaslogin%3Furl%3Dhttps%253A%252F%252Fwww.vmall.com%252F&amp;lang=zh-cn&amp;themeName=red"),
	  
		status:htmlDecodeJQ(""),
		twoStepVerify:htmlDecodeJQ("")
    };
</script>

</head>

<body class="forget" id="loginform">


					      							
		<!-- 头部  -->

<div class="head-background">
	<div class="head_center">
		
		     
			  	<div class="main-logo adHeadPicContainer" style="width:143px">
					<img src="picture/head-top.png" class="wihteBgPic">
				</div>
				<div class="website-name"  style="color:#fff;">
					<b style="font-size: 18px;margin-top: -3px;float: left;color:#cccccc;">|</b>
					<b style="font-size: 18px;margin-top: -1px;float: left; margin-left:18px;color:#ffffff">华为商城</b>
				</div>
			
		
	</div>
</div>
	
	
	
	
	
    <div class="g">
    	<!--找回密码 -->
    	<div id="mod-forget-area" class="resetpwd-container">
        	<div class="h">
            	<h3><span>忘记密码</span></h3>
            </div>
            <div class="b">
                <div id="resetByIdFrom">
                	<!--表单 -->
                	<input type="hidden" name="sessionExpireFlag" id="sessionExpireFlag" value="" />
                	<input type="hidden" name="formBean.reqClientType" value="26" />
                	
                	<div class="form-edit-area">
                		<div class="head_text"><em>输入华为帐号</em></div>
                		<div id="username-input" class="input-area forIdmarBot marginBottom0">
                			<input type="text" autocomplete="off"  class="text vam" id="formBean_username"  name="formBean.username" maxlength="50" tabindex="1"  /><span id="msg_username"></span>
                            <input type="hidden" id="fullUserAccount"  value="" />
                		</div>
                        <div id="error-tips" class="error-tips-EMUI6"></div>
                        
                		<div class="input-area">
							<div class="verifyCode" id="randomCodeDiv" >
								<input type="text" autocomplete="off" id="randomCode" name="randomCode" class="text vam paddingFix" style="width:80%" maxlength="4" tabindex="1">
							</div>
							<img src="/Homes/picture/8a62d301b4ad4e8dbcfad1da71971d2c.gif" id="randomCodeImg" class="randomCodeImg forIdCodeImg" alt="验证码" onclick="chgRandomCodeForReset();" onload="if(this.src.indexOf('loading.gif')==-1){this.style.width='100px'}" onerror="this.style.width='44px';this.src='https://hwid1.vmallres.com/CAS/up/rss_16/css/mobile/standard_rss/images/loading.gif?UP_CAS_2.6.0.102';"/>
							<b id="authCodeRight"></b>
						</div>	
						<div id="randomCode_msg" class="error-tips-EMUI6"></div>
                    </div>
                    <div class="input-area step-area">
               			<input type="button" id="btnSubmit" class="button" value="下一步"  tabindex="3" style="width:210px;"/>
               		</div>
                </div>
            </div>
            <div class="f"></div>
    	</div>
    </div>
    <div id="selectCountryCodeDiv"></div>
    
    
					      							
		<!-- 底部  -->

<div class="customer-footer">
	<div class="ft">
		<!--授权  -->
        <div class="warrant-area">
            <p style="text-align: center;height-line:20px;height:20px;">
			 
				
				
						<a href="https://hwid1.vmall.com/CAS/portal/agreements/userAgreement/zh-cn_userAgreement.html?version=china" class="rule" target="_blank">用户协议</a>            	
						<em class="foot_em">|</em>
						<a href="https://hwid1.vmall.com/CAS/portal/agreements/userPrivacyPolicy/zh-cn_userPrivacyPolicy.html?version=europe" class="rule" target="_blank">隐私政策</a>
				
				
			
			
			
			
			
			
			
           	<a href="#" target="_blank"><em style='font-style: normal'>|</em> <a style="padding:0 10px;" target="blank" href="https://hwid1.vmall.com/CAS/portal/faq/faq.html">常见问题</a></a>
            </p>
        	<p style="text-align: center;line-height: 12px;height:12px;margin-top: 10px ">
        	
        		
        			
        				Copyright © 2011-2017  华为软件技术有限公司  版权所有  保留一切权利  苏B2-20070200号 | 苏ICP备09062682号-9
        			
        			
        		
        	
        	</p>
        </div>
    </div>
</div>



	
	
</body>

<script src="js/forgetpassword.js"></script>
<script>
ec.ready(function () {
	//页面一进入就刷新下图片验证码
	
	if($("#sessionExpireFlag").val() == "expired") {
		
		$("#sessionExpireFlag").val('');
	}
	var username = $("#formBean_username");
	var btnSubmit=$("#btnSubmit");
	var submitForm=$(".form-edit-area");
	var randomCode = $('#randomCode');
	
	username.bind("onkeyup", function(){
		hideUsernameError();
	});

	//bind username event
	
 	 username.validator("bind",{
		type:["require","length"],
		trim:true,
		min:4,
		max:50,
		validOnChange:true, 
		errorClassEMUI5:"input-error-EMUI5",
		errorBorder:$("#username-input"),
		errorFunction:function(obj,options){
			switch(options.type){
				case "require":
					showUsernameError("null");
					break;
				case "length":
					showUsernameError("华为帐号限制在4~50 个字符");
					break;
			}
		},
		successFunction:function(obj,options){
			hideUsernameError();
		},
		reInputFunction:function()
		{
			hideUsernameError();
		}			
	}); 
	
 	randomCode.validator("bind",{
		type:["require","length"],
		trim:true,
		min:4,
		max:4,
		validOnChange:false,
		errorClassEMUI5:"input-error-EMUI5",
		errorBorder:$("#randomCodeDiv"),
		errorFunction:function(obj,options){
			
			switch(options.type){
				case "require":
					showRandomCodeError(rss.inputcode);
					break;
				case "length":
					showRandomCodeError(rss.login_js_codeerror);
					break;
			}
		},
		successFunction:function(obj,options){
			hideRandomCodeError();
		},
		reInputFunction:function()
		{
			hideRandomCodeError();
		}	
	}); 
	
	ec.form.input.label(username , htmlDecodeJQ("&#25163;&#26426;&#21495;/&#37038;&#20214;&#22320;&#22336;"));
	
	ec.form.input.label(randomCode , htmlDecodeJQ("&#39564;&#35777;&#30721;"));

	username.keyup(function(){
		validateInput();
	});
	
	$("#randomCode").bind("keyup", function(evt) {
		validateInput();
		checkImgAuthCode();
		// 确保只弹出一个框 二次认证框
		if (evt.which == 13) {
			$("#btnSubmit").click();
			return;
		}
		if($('#randomCode').val().trim().length < 4){
			$("#authCodeRight").removeClass("poptips-yes");
		}
	});
	
	btnSubmit.bind("click",function(){
		
		if ($("#btnSubmit").hasClass("disabled")){
			return false;
		}
		
		var form=$(".form-edit-area")[0];
		if(!validator(form,true)){
			return false;
		}
		 var inputUserAccount = $("#formBean_username").val().trim();

	        
	    inputUserAccount = convPlusOfPhoneAccount(inputUserAccount);
		querySiteInfo(inputUserAccount, function(siteInfoObjArr,data){
			if (siteInfoObjArr.length == 1) {
				
				var crossSiteModel=data.crossSiteModel;
            	if(crossSiteModel!=0)
            	{
            		var redirectSiteUrl = data.redirectSiteUrl;

                    if(redirectSiteUrl.indexOf("oauth2")>0)
                    {
                    	redirectSiteUrl= redirectSiteUrl.substr(0,redirectSiteUrl.indexOf("oauth2"))+"oauth2/portal/forgetbyid.jsp";
                    	redirectSiteUrl = redirectSiteUrl + localInfo.queryString;
                    }
                    else
                    {
                    	redirectSiteUrl = redirectSiteUrl + localInfo.requestURIQuery;
                    }
                    
                    if(data.extInfo)
					{
						if(redirectSiteUrl.indexOf("?")>0)
						{
							redirectSiteUrl=redirectSiteUrl + "&extInfo=" + data.extInfo;
						}
						else
						{
							redirectSiteUrl=redirectSiteUrl + "?extInfo=" + data.extInfo;
						}
					}
                    
                    openGlobalCrossSiteDialog(redirectSiteUrl);
                    return;
            	}
				 
				 var fullUserAccount = inputUserAccount;
	    		 if (getAccountType(inputUserAccount) == 2) {
	    			 var countryCode = siteInfoObjArr[0].countryCode;
	    			 if (inputUserAccount.substring(0,2) != "00" && countryCode!="0") {
		 	        	 fullUserAccount = "00"+countryCode + inputUserAccount;
		 	         }
	    		 }
	 	        	 	    	  
	 	    	 $("#fullUserAccount").val(fullUserAccount);

	    	  }
	    	  else if (siteInfoObjArr.length > 1) {
	 	    	 openCountryCodeDialog(siteInfoObjArr);
	 	    	 return;
	 	     }else{
	 	    	showUsernameError(rss.user_not_exsit);
	 	    	return false;
	 	     }
		     
			//检查风控
			var dataParms ={
					accountType:getAccountType($("#formBean_username").val().trim()),
					userAccount:$("#formBean_username").val().trim(),
					sceneID:15,
					reqClientType:localInfo.reqClientType,
					noLogin:true,
					callback:function(){
						getAccountListFun();
					},
					showRiskError:function(errorCode)
					{
						
						if(errorCode=="70008800")
						{
							showSystemError(rss.error_risk_70008800,rss.iKnowBtn);
						}
						else
						{
							showSystemError(rss.overload,rss.iKnowBtn);
						}	
						$("#randomCodeImg").click();
					}
			}
			chkSecurityRiskFn(dataParms);
				
				
			 
		});

	});
	
	/***reg validate type***/
	ec.form.validator.register("chinaLang", function(b, a) {
		if (a.allowEmpty && ec.util.isEmpty(b)) {
			return true;
		}
		
		if (b.length != 4) {
			return false;
		}
		else
		{
			return true;
		}
	});
	
	//验证码里面tip样式调整
	//  避免重复输入帐号
	if(localInfo.extInfo)
	{
		$("#formBean_username").val(localInfo.extInfo);
	}
	validateInput();
	
});


function openGlobalCrossSiteDialog(globalCrossSiteUrl)
{
	var htmlStr=rss.global_cross_page_redirect_forget;
	$("<div>").Dialog({
		title:rss.prompt,
		btnLeft:{
			text:rss.cancel_btn,
			fn:function(){
				this.hide();
			}
		},
		btnRight:{
			text:rss.iKnowBtn,
			fn:function(){
				gotoUrl(globalCrossSiteUrl);
			}
		},
		html:htmlStr,
		beforeAction:function(){
			
		}
	}).Dialog("show");
}



function openCountryCodeDialog(siteInfoObjArr) {
    var htmlStr = '<div class="mask"></div>';
    htmlStr += '<div class="dialog">';
    htmlStr += '<div class="dcent">';
    $.each(siteInfoObjArr, function(index, value) {
        var siteInfoObj = value;
        htmlStr += '<div class="code-node line mkcl">';
        htmlStr += '<b data-value="false" class="ccr radio roff r" data="'+siteInfoObj.siteID+'"></b>';
        htmlStr += '<p class="item">';
        var countryCodeDisplay = "+" + siteInfoObj.countryCode;
        htmlStr += '<span class="split cc">' + countryCodeDisplay + '</span><span class="split">' + $("#formBean_username").val() + '</span>';
        htmlStr += '</p>';
        htmlStr += '</div>';

    });
    htmlStr += '</div>';
    htmlStr += '</div>';
    $("#selectCountryCodeDiv").html(htmlStr);

    $(".radio").on("click", function(e) {
        $(this).removeClass('roff');
        $(this).addClass('ron');
        var self = $(this);
        setTimeout(function() {
            var countrycode = self.parent().find(".cc").text().trim().replace("+", "00");
            var newUserAccount = countrycode + $("#formBean_username").val();
            $("#selectCountryCodeDiv").html("");
            $("#formBean_username").val(newUserAccount);
            $("#fullUserAccount").val(newUserAccount);
            localInfo.siteID = self.attr("data");
            if (localInfo.currentSiteID != localInfo.siteID) {
                openGotoOwnSiteDialog();
           } 
        }, 200);

    });

}
function openGotoOwnSiteDialog() {
    var htmlStr = rss.noSupportService;
    $("<div>").Dialog({
      title: rss.prompt,
      btnLeft : false,
      btnRight : {
            text : rss.iKnowBtn,
            fn : function() {
                this.hide(); 
     
            }
      },
      html : htmlStr,
      beforeAction : function() {
 
      }

  }).Dialog("show");
    
}

function querySiteInfo(userAccount,callbackFn) {
	// 账号为空，不需要访问后台
	if (!userAccount)
	{
		return;
	}
	
	var randomCode = $("#randomCode");
	var randomCodeVal = $("#randomCode").val();
	if (!randomCodeVal)
	{
		return;
	}
	
    var dataParms = {
    	"operType": 1,
    	"randomCode": randomCodeVal,
    	"session_code_key" : "p_forget_byid_session_ramdom_code_key",
        "userAccount" : userAccount,
        "reqClientType" : localInfo.reqClientType
    };
    ajaxHandler("isExsitUserForForgetPwd", dataParms, function(data) {
        var isSuccess = data.isSuccess;
        var errorCode = data.errorCode;
        var crossSiteModel = data.crossSiteModel;
        
        if (isSuccess == 1) {
        	
            var siteInfoObjArr = [];
            if (data.existAccountFlag == 1 || data.existAccountFlag == 2) {
                var siteInfoList = data.siteInfoList;
                if (siteInfoList) {
                    for (var i = 0; i < siteInfoList.length; i++) {
                        var siteInfo = siteInfoList[i];
                        var siteInfoObj = {};
                        siteInfoObj.siteID = siteInfo.siteID;
                        siteInfoObj.countryCode = siteInfo.cy;
                        siteInfoObj.loginUrl = siteInfo.loginUrl;
                        siteInfoObjArr.push(siteInfoObj);
                    }
                }
            }
            callbackFn(siteInfoObjArr,data);
        }
        else
        {
        	if(errorCode=="10000507")
        	{
        		var redirectSiteUrl = data.redirectSiteUrl;

                if(redirectSiteUrl.indexOf("oauth2")>0)
                {
                	redirectSiteUrl= redirectSiteUrl.substr(0,redirectSiteUrl.indexOf("oauth2"))+"oauth2/portal/forgetbyid.jsp";
                	redirectSiteUrl = redirectSiteUrl + localInfo.queryString;
                }
                else
                {
                	redirectSiteUrl = redirectSiteUrl + localInfo.requestURIQuery;
                }
                
                if(data.extInfo)
				{
					if(redirectSiteUrl.indexOf("?")>0)
					{
						redirectSiteUrl=redirectSiteUrl + "&extInfo=" + data.extInfo;
					}
					else
					{
						redirectSiteUrl=redirectSiteUrl + "?extInfo=" + data.extInfo;
					}
				}
                
                openGlobalCrossSiteDialog(redirectSiteUrl);
        	}
        	else if (errorCode=="10000201")
        	{
        		var randomCodeImg = $('#randomCodeImg');
        		var randomCodeError = $("#randomCode_msg");
        		
				chgRandomCode(randomCodeImg[0],
						localInfo.webssoLoginSessionCode);
				randomCode[0].value = "";
				
				$("#authCodeRight").removeClass("poptips-yes");
				validateInput();
				
				showRandomCodeError(rss.common_js_wrongcode);
        	}
        	else if(errorCode=="70008800")
			{
				showSystemError(rss.error_risk_70008800,rss.iKnowBtn);
				$("#randomCodeImg").click();
			}
        }

    }, function() {
    }, false, "json");

}

//转换电话号码前的加号
function convPlusOfPhoneAccount(account) {
	// The telephone number plus conversion
	if (account)
	{
		var temp = account.replace(/^\s+|\s+$/g, ''); // 去掉头尾空白字符

		var ch = temp.charAt(0);
		
		if (ch == '+')
		{
			return "00" + temp.substring(1);
		}
		
		return temp;
	}
	
	return account;
}

//检查图片验证码
function checkImgAuthCode() {
	var randomCode = $("#randomCode");
	var randomCodeImg = $('#randomCodeImg');
	var randomCodeError = $("#randomCode_msg");
	if (typeof (randomCode[0]) != "undefined"
			&& randomCode.val().length >= 4) {
		var thisValue = randomCode.val();
		var dataParms = {
			randomCode : thisValue,
			session_code_key : "p_forget_byid_session_ramdom_code_key"
		};

		ajaxHandler("authCodeValidate", dataParms, function(data) {
			if ("1" == data.isSuccess) {
				$("#authCodeRight").addClass("poptips-yes");
				hideRandomCodeError();
				
				validateInput();
				$("#btnSubmit").focus();
			} else {
				chgRandomCode(randomCodeImg[0],
						localInfo.webssoLoginSessionCode);
				randomCode[0].value = "";
				
				$("#authCodeRight").removeClass("poptips-yes");
				validateInput();
				
				switch (data.errorCode) {
				case '10000201': {
					showRandomCodeError(rss.common_js_wrongcode);
					break;
				}
				case '10000001': {
					showRandomCodeError(rss.error_10000001);
					break;
				}
				case '10000004': {
					showRandomCodeError(rss.error_10000004);
					break;
				}
				default: {
					showRandomCodeError(rss.error_10000002);
					break;
				}
				}
			}

		}, function(data) {

		}, true, "JSON");

	} else if (typeof (randomCode[0]) != "undefined"
			&& randomCode.val().length != 4) {
	}
}

function chgRandomCodeForReset() {
	
	var randomCode = $("#randomCode");
	var randomCodeImg = $('#randomCodeImg');
	
	chgRandomCode(randomCodeImg[0], localInfo.webssoLoginSessionCode);
	randomCode.val("");
	$("#authCodeRight").removeClass("poptips-yes");
}

var formBean_usernameValue = $("#formBean_username").val();
function validateInput()
{
	var formBean_usernameValue = $("#formBean_username").val();
	var randomCodeValue = $("#randomCode").val();
	
	if (formBean_usernameValue.length >0)
	{
		formBean_usernameValue = formBean_usernameValue.trim();
	}else if (formBean_usernameValue.length >0){
		
	}
	
	if (randomCodeValue)
	{
		randomCodeValue = randomCodeValue.trim();
	}
	
	
	if (formBean_usernameValue && formBean_usernameValue.length >=1 
			&& randomCodeValue && randomCodeValue.length >=1)
	{
		
		$("#btnSubmit").removeClass("disabled");
		
	}
	else
	{
		$("#btnSubmit").addClass("disabled");
	}
	
}


function showUsernameError(errorMsg)
{
	$("#error-tips").html(errorMsg);
	$("#error-tips").addClass("addbtmpad-msg-top8N-bottom8");
	$("#username-input").addClass("input-error-EMUI5");
}

function hideUsernameError()
{
	$("#error-tips").html("");
	$("#error-tips").removeClass("addbtmpad-msg-top8N-bottom8");	
	$("#username-input").removeClass("input-error-EMUI5");
}

function showRandomCodeError(errorMsg)
{
	$("#randomCode_msg").html(errorMsg);
	$("#randomCode_msg").addClass("addbtmpad-msg-top4-bottom10");
	$("#randomCodeDiv").addClass("input-error-EMUI5");
}

function hideRandomCodeError()
{
	$("#randomCode_msg").html("");
	$("#randomCode_msg").removeClass("addbtmpad-msg-top4-bottom10");	
	$("#randomCodeDiv").removeClass("input-error-EMUI5");
}

function getAccountListFun()
{
     var fullUserAccount = $("#fullUserAccount").val();
	 var username=$("#resetByIdFrom input[name='formBean.username']").val();
	 if (fullUserAccount) {
	     username = fullUserAccount;
	 }
	 var reqClientType=$("#resetByIdFrom input[name='formBean.reqClientType']").val();
	 var buttonSmt=$("#btnSubmit");
	//让按钮失效，为了保证按钮不会被多次点击
	 buttonSmt.attr("disabled","disabled");
	 
	 var randomCodeVal = $("#randomCode").val();
	 
	 var strParms="getUserAccInfo";
	 var dataParms={
	 		 "operType":1,
		     "randomCode": randomCodeVal,
		     "session_code_key" : "p_forget_byid_session_ramdom_code_key",
			 "userAccount":username,
			 "reqClientType":reqClientType
	 };
	 ajaxHandler(strParms,dataParms,function(data){
		 buttonSmt.removeAttr("disabled");
		 var isSuccess=data.isSuccess;
		 var errorCode=data.errorCode;
		 if(isSuccess=="1") 
		 {
			 var userAcctInfoList=data.userAcctInfoList;
			 var accountTypes = new Array();
			 $.each(userAcctInfoList,function(n,value) {   
				 accountTypes.push(value.accountType);
			 });  
			
			 if(accountTypes.length<=0) 
		     {
				 showUsernameError(rss.accountNotActive);
				 return false;
		     }
			 else
			 {
				 
			 
				  // 账号申诉2.0
				  var result = getTwoFacRecovery(data.userID, username);
				  return result;
		      }
				 
		
		 }
		 else 
		 {
			 if(errorCode == "10000001") 
			 {
				 showUsernameError( rss.error_10000001);
			 }else if(errorCode == "10000004") 
			 {
				 showUsernameError( rss.error_10000004);
			 }else if(errorCode == "10000002") 
			 {
				 showUsernameError( rss.error_10000002);
			 }
			 else if(errorCode=="10000201")
			 {
				 showRandomCodeError(rss.common_js_wrongcode);
				 $("#randomCode").focus();
				 chgRandomCodeForReset();
			 }
			 else if(errorCode=="70001401")
			 {
				 showSystemError(rss.error_70001401,rss.iKnowBtn)
			 }
			 else 
			 {
				 showUsernameError( rss.user_not_exsit);
			 }
			 return false;
		 }
	 },function(){},true,"json");
}
function getTwoFacRecovery(userID, userAccount)
{
	 var strParms="getTwoFacRecovery";
	 var dataParms={
	 };
	 
	// 账号申诉2.0
	ajaxHandler(strParms,dataParms,function(data){
		var accountRecoverState = data.accountRecoverState;
		var errorCode=data.errorCode;
		if(data.isSuccess=="1") 
		{
			 if (localInfo.clientNonce)
		     {
				 // extInfo、sceneID、clientNonce
				 gotoUrl(data.nextStepUrl + localInfo.urlQurey + "&sceneID=1&clientNonce=" + localInfo.clientNonce + "&extInfo=" + data.extInfo);
			 }
			 else
		     {
				 gotoUrl(data.nextStepUrl + localInfo.urlQurey + "&sceneID=1&extInfo=" + data.extInfo);
			 }						 
			 
			 return true;
		}
		else
		{
			 if(errorCode == "10000001") 
			 {
				showUsernameError(rss.error_10000001);
			 }else if(errorCode == "10000004") 
			 {
				showUsernameError(rss.error_10000004);
			 }else if(errorCode == "10000002") 
			 {
				showUsernameError( rss.error_10000002);
			 }else if(errorCode == "10000003"){
				showUsernameError(rss.error_10000003);
			 }
			 else if(errorCode == "10001003") 
			 {
				 showUsernameError( rss.error_10001003);
			 }
			 else if(errorCode == "10001004") 
			 {
				 showUsernameError( rss.error_10001004);
			 }
			 else if(data.errorCode=="70001401")
			 {
				showUsernameError( rss.error_70001401);
			 }
			 else 
			 {
				showUsernameError( rss.user_not_exsit);
			 }
			 return false;			
		}
	});		
}
</script>
<script src="js/swfobject.js"></script>
<script src="js/acctguard-secure.min.js"></script>

</html>