ec.pkg("ec.product.gift");ec.product.gift={proGiftChosenImgSrc:"",proGiftChosenImgAlt:"",proGiftGallerys:[],giftTrees:[],data:"",giftArrays:{},defaultGift:[],mainSkuGiftMap:{},mainSkuGiftKeyMap:{},defaultGiftMap:{},finalMainSbomGiftMap:{},tempMainSbomGiftMap:{},isChange:"true",picMediaServer:ec.mediaPath,sku:"",middleImgSize:"55_55_",navImgSize:"55_55_",ITEM_WIDTH:52,isChange:false,popupHtml:function(){var e=[],f=[],b=0,a=0;var k="";var h=ec.product.getSku();defaultGift=this.defaultGiftMap[h];multiGiftVO=this.mainSkuGiftMap[h];multiGiftVOKeys=this.mainSkuGiftKeyMap[h];finalGift=this.finalMainSbomGiftMap[h]||{};giftSize=multiGiftVOKeys.length;var j=[],g=[];for(var d=0;d<giftSize;d++){var c=multiGiftVO[multiGiftVOKeys[d]];if(multiGiftVOKeys[d].indexOf("_")<0){if(d>0){f.push(this.renderSingleGift(g,j));j=[];g=[]}j.push(c);g.push(multiGiftVOKeys[d])}if((multiGiftVOKeys[d].indexOf("_")>0&&d>0)){j.push(c);g.push(multiGiftVOKeys[d])}if(d==(giftSize-1)){f.push(this.renderSingleGift(g,j));j=[];g=[]}}e.push(f.join(" "));return e.join(" ")},renderSingleGift:function(d,c){var a=c.length;defaultGift=c[0];finalGift=this.finalMainSbomGiftMap[this.sku];choseGift=finalGift[d[0]];if(d.length!=c.length){}html=[];html.push('<div class="product-partscolor-detail clearfix">');html.push('<a id="gift-detail-'+d[0]+'"  onclick=\'_paq.push(["trackLink","Click pc_wds_gift_prodct", "link",""]);ec.code.addAnalytics({hicloud:true})\'  href="/product/'+choseGift.giftId+".html#"+choseGift.giftSkuId+'" target="_blank">');html.push('<img class="product-partscolor-detailimg" src="'+this.picMediaServer+choseGift.photoPath+this.middleImgSize+choseGift.photoName+'">');html.push("</a>");html.push('<div class="product-partscolor-list"> ');html.push('<h2 id="gift-detail-name'+d[0]+'">'+choseGift.giftName+"</h2>");html.push('<ul class="clearfix">');for(var b=0;b<a;b++){if(choseGift.giftSkuId==c[b].giftSkuId){html.push('<li class="selected">')}else{html.push("<li>")}html.push('<a href="javascript:;" key="'+d[b]+'" defaultGiftKey="'+d[0]+'" title="'+c[b].giftAttrVal+'">');html.push('<img src="'+this.picMediaServer+c[b].photoPath+this.navImgSize+c[b].photoName+'">');html.push("<p><span>"+c[b].giftAttrVal+"</span></p>");html.push("</a>");html.push("</li>")}html.push("</ul>");html.push("</div>");html.push("</div> ");return html.join(" ")},ftl:function(e){this.sku=ec.product.getSku();var c=[];var b=this.defaultGiftMap[e];var d=this.mainSkuGiftMap[e];var a=this.finalMainSbomGiftMap[e]||{};for(var f=0;f<b.length;f++){var g=d[b[f]];if(g){a[g.giftId]=g;c.push('<a id="gift-'+g.giftId+'" onclick=\'_paq.push(["trackLink","Click pc_gift_prodct", "link",""]);ec.code.addAnalytics({hicloud:true})\' href="/product/'+g.giftId+".html#"+g.giftSkuId+'" target="_blank" title="'+g.giftName+'">');c.push('<img src="'+this.picMediaServer+g.photoPath+this.navImgSize+g.photoName+'" alt="'+g.giftName+'"></a>')}}this.finalMainSbomGiftMap[e]=a;$("#pro-gift-list-detail").html(this.popupHtml());$("#pro-gift-list-detail").find("ul li a").click(function(){if($(this).parent().hasClass("selected")){return}$(this).parent().toggleClass("selected").siblings().removeClass("selected");var k=ec.product.getSku();var j=ec.product.gift.mainSkuGiftMap[k];var i=ec.product.gift.finalMainSbomGiftMap[k];var h=$(this).attr("key");var l=j[h];var m=$(this).attr("defaultGiftKey");i[m]=l;$("#gift-detail-"+m).find("img").attr("src",ec.product.gift.picMediaServer+l.photoPath+ec.product.gift.middleImgSize+l.photoName);$("#gift-detail-"+m).attr("href","/product/"+l.giftId+".html#"+l.giftSkuId);$("#gift-detail-name"+m).html(l.giftName);$("#gift-"+m).attr("href","/product/"+l.giftId+".html#"+l.giftSkuId);$("#gift-"+m).attr("title",l.giftName);$("#gift-"+m).find("img").attr("src",ec.product.gift.picMediaServer+l.photoPath+ec.product.gift.middleImgSize+l.photoName);$("#gift-"+m).find("img").attr("alt",l.giftName)});return c.join("")},init:function(j,k){if(!k&&!j){return}var b={};var d=[];var c=[];this.giftArrays=k;var e=[];var h=0,a=0;for(var g=0;g<k.length;g++){var f=b[k[g].giftId];if(!f){c.push(k[g].giftId);b[k[g].giftId]=k[g];d.push(k[g].giftId);++a}else{b[k[g].giftId+"_"+h]=k[g];d.push(k[g].giftId+"_"+h);h++}}this.mainSkuGiftMap[j]=b;this.mainSkuGiftKeyMap[j]=d;this.defaultGiftMap[j]=c},cloneObj:function(c){var d,b=c.constructor===Array?[]:{};if(typeof c!=="object"){return}else{if(window.JSON){d=JSON.stringify(c),b=JSON.parse(d)}else{for(var a in c){b[a]=typeof c[a]==="object"?cloneObj(c[a]):c[a]}}}return b},getGiftsSize:function(){var c=ec.product.getSku(),a=0;multiGiftVOKeys=this.mainSkuGiftKeyMap[c];giftSize=multiGiftVOKeys.length;for(var b=0;b<giftSize;b++){if((multiGiftVOKeys[b].indexOf("_")<0)){++a}}return a}};
